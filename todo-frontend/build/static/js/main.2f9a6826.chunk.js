(this["webpackJsonptodo-frontend"]=this["webpackJsonptodo-frontend"]||[]).push([[0],{69:function(e,t,n){},70:function(e,t,n){},82:function(e,t,n){"use strict";n.r(t);var o=n(0),a=n(11),r=n.n(a),c=(n(69),n(70),n(33)),s=n(8),i=n(20),l=n.n(i),u=n(29),d=n(22),j=n(112),f=n(113),b=n(36),h=n(109),v=n(118),p=n(110),O=n(111),g=n(56),m=n.n(g),x=n(57),k=n.n(x),w=n(58),y=n.n(w),T=n(114),S=n(115),C=n(107),I=n(2);function N(e){var t=e.item,n=e.isSubTask,a=e.todos,r=(e.setTodos,e.updateTodoTask),c=e.onAddSubtask,s=e.onDeleteCall,i=e.onDeleteSubtaskCall,l=e.parentId,u=Object(o.useState)(!1),j=Object(d.a)(u,2),f=j[0],g=j[1],x=Object(o.useState)(""),w=Object(d.a)(x,2),N=w[0],P=w[1],E=t.value,_=t.id,U=function(e){return null===a||void 0===a?void 0:a.find((function(t){return t.id===e}))},D=function(){var e;g(!1),console.log("click away");var t=U(l);console.log("foundParent before ",t);var n=null===t||void 0===t||null===(e=t.subtasks)||void 0===e?void 0:e.filter((function(e){return e.id!==N.id}));console.log("filtered ",n),n.length?(console.log("else part"),null===n||void 0===n||n.push(N),console.log("filtered elese",n),t.subtasks=n,t.subtasks=t.subtasks.filter((function(e){if(e)return e}))):t.subtasks=[N],console.log("foundParent =>after ",t),r(t)};return Object(I.jsx)(C.a,{onClickAway:function(){console.log("away ",N),n?D():r(N),g(!1)},children:Object(I.jsx)("div",{className:"todo__container",children:f?Object(I.jsx)(S.a,{defaultValue:null===N||void 0===N?void 0:N.value,style:{width:"330px"},onChange:function(e){return function(e){if(n){var t=U(l),o=null===t||void 0===t?void 0:t.subtasks.find((function(e){return e.id===_}));P(Object(b.a)(Object(b.a)({},o),{},{value:e.target.value}))}else{var r=a.find((function(e){return e.id===_}));P(Object(b.a)(Object(b.a)({},r),{},{value:e.target.value}))}}(e)},onKeyDown:function(e){n&&"Enter"===e.key?(console.log("sub"),D()):"Enter"===e.key&&(g(!1),r(N),P(""))},autoFocus:!0}):Object(I.jsx)("div",{className:n?"todo__itemSubtask":"todo__item",children:Object(I.jsxs)(h.a,{role:void 0,dense:!0,button:!0,children:[Object(I.jsx)(v.a,{id:_,primary:E}),Object(I.jsxs)(p.a,{children:[n?"":Object(I.jsx)(T.a,{title:"Add Subtask",placement:"left-start",children:Object(I.jsx)(O.a,{onClick:function(){return c(_)},edge:"end","aria-label":"add",children:Object(I.jsx)(m.a,{})})}),Object(I.jsx)(T.a,{title:"Edit",placement:"top",children:Object(I.jsx)(O.a,{edge:"end","aria-label":"edit",onClick:function(){!function(e,t){if(n){console.log("sub task edit");var o=U(e);console.log("foundParent ",o);var a=null===o||void 0===o?void 0:o.subtasks.find((function(e){return e.id===t}));console.log("foundSubTaskNode ",a),P(a),g(!0)}else{g(!0);var r=U(t);P(r)}}(l,_)},children:Object(I.jsx)(k.a,{})})}),Object(I.jsx)(T.a,{title:"Delete",placement:"right-start",children:Object(I.jsx)(O.a,{onClick:function(){return n?i(l,_):function(e){console.log("on delete ",e),s(e)}(_)},edge:"end","aria-label":"comments",children:Object(I.jsx)(y.a,{})})})]})]},_)})})})}var P=n(116),E={loginUrl:"http://".concat(window.location.hostname,"/api/login"),todosUrl:"http://".concat(window.location.hostname,"/api/todos")},_=Object(j.a)((function(e){return{root:{width:"100%",maxWidth:360,backgroundColor:e.palette.background.paper}}}));var U=function(){var e=_(),t=Object(o.useState)([]),n=Object(d.a)(t,2),a=n[0],r=n[1],s=Object(o.useState)(""),i=Object(d.a)(s,2),j=i[0],b=i[1],h=function(){var e=Object(u.a)(l.a.mark((function e(t,n){var o,a,r;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t&&!n){e.next=10;break}return o=t?"".concat(E.todosUrl,"/").concat(t):E.todosUrl,console.log(" path => ",o),e.next=5,fetch(o,{method:t?"PUT":"POST",mode:"cors",cache:"no-cache",credentials:"same-origin",headers:{"Content-Type":"application/json",authorization:"Bearer ".concat(localStorage.getItem("token"))},redirect:"follow",referrerPolicy:"no-referrer",body:JSON.stringify(t?n:j)});case 5:return a=e.sent,e.next=8,a.json();case 8:r=e.sent,console.log("create todo res ",r);case 10:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),v=function(){var e=Object(u.a)(l.a.mark((function e(t){var n,o,a;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n="".concat(E.todosUrl,"/").concat(t),e.next=3,fetch(n,{method:"DELETE",mode:"cors",cache:"no-cache",credentials:"same-origin",headers:{"Content-Type":"application/json",authorization:"Bearer ".concat(localStorage.getItem("token"))},redirect:"follow",referrerPolicy:"no-referrer"});case 3:return o=e.sent,e.next=6,o.json();case 6:a=e.sent,console.log("create todo res ",a);case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),p=function(){var e=Object(u.a)(l.a.mark((function e(){var t,n,o;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch(E.todosUrl,{method:"GET",mode:"cors",cache:"no-cache",credentials:"same-origin",headers:{"Content-Type":"application/json",authorization:"Bearer ".concat(localStorage.getItem("token"))},redirect:"follow",referrerPolicy:"no-referrer"});case 2:return t=e.sent,e.next=5,t.json();case 5:n=e.sent,o=n.data,console.log("updated data",o),(null===o||void 0===o?void 0:o.length)?r(o):r([]);case 9:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();Object(o.useEffect)((function(){p()}),[]);var O=function(e){console.log("TodoList ",e),v(e),setTimeout((function(){p()}),500)},g=function(e,t){var n=a.findIndex((function(t){return t.id===e})),o=a[n],r=o&&o.subtasks.filter((function(e){return e.id!==t}));o.subtasks=r,h(e,o),setTimeout((function(){p()}),500)},m=function(e){var t=prompt("Please enter your subtask","");if(t){var n={id:Object(P.a)(),value:t},o=a.findIndex((function(t){return t.id===e})),r=a[o];r&&r.subtasks.push(n),h(e,r),setTimeout((function(){p()}),500)}},x=function(e){e&&(console.log(" parentId,editTodo ",null===e||void 0===e?void 0:e.id,e),h(null===e||void 0===e?void 0:e.id,e),setTimeout((function(){p()}),500))},k=Object(o.useMemo)((function(){return Object(I.jsx)(f.a,{className:e.root,id:"container",children:a.map((function(e){return Object(I.jsxs)("div",{className:"todo_task",children:[Object(I.jsx)(N,{item:e,onDeleteCall:O,onAddSubtask:m,todos:a,setTodos:r,updateTodoTask:x},e.id),e.subtasks&&e.subtasks.length?e.subtasks.map((function(t){return t?Object(I.jsx)("div",{className:"todo_subtask",children:Object(I.jsx)(N,{isSubTask:!0,parentId:e.id,item:t,todos:a,setTodos:r,updateTodoTask:x,onDeleteSubtaskCall:g},t.id)},t.id):null})):Object(I.jsx)("div",{})]},e.id)}))})}),[a]);return Object(I.jsxs)("div",{className:"todo_list",children:[Object(I.jsxs)("div",{className:"todo_header",children:[Object(I.jsx)("h1",{children:"Todo App"}),Object(I.jsx)(c.b,{to:"/",onClick:function(){localStorage.removeItem("token")},children:"Logout"})]}),Object(I.jsxs)("div",{className:"todo__input",children:[Object(I.jsx)(S.a,{disableUnderline:!0,value:null===j||void 0===j?void 0:j.value,placeholder:"Please Enter Todo Task",style:{width:"330px"},onChange:function(e){return function(e){var t={id:Object(P.a)(),value:e.target.value,subtasks:[]};b(t)}(e)},onKeyDown:function(e){if("Enter"===e.key&&j){h(!1,j),p();var t={id:Object(P.a)(),value:"",subtasks:[]};b(t)}}}),k]})]})};var D=function(){var e=Object(o.useState)(""),t=Object(d.a)(e,2),n=t[0],a=t[1],r=Object(o.useState)(""),c=Object(d.a)(r,2),i=c[0],j=c[1],f=Object(s.f)();Object(o.useEffect)((function(){var e=localStorage.getItem("token");console.log("token useEffect",e),e&&f.push("/todos")}));var b=function(e){console.log(e.target.name,e.target.value),"username"===e.target.name?a(e.target.value):j(e.target.value)},h=function(){var e=Object(u.a)(l.a.mark((function e(t){var o,a,r;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),console.log(n,i),!n||!i){e.next=15;break}return console.log("config.loginUrl ",E.loginUrl),e.next=6,fetch(E.loginUrl,{method:"POST",mode:"cors",cache:"no-cache",credentials:"same-origin",headers:{"Content-Type":"application/json"},redirect:"follow",referrerPolicy:"no-referrer",body:JSON.stringify({username:n,password:i})});case 6:return o=e.sent,e.next=9,o.json();case 9:a=e.sent,r=a.token,console.log("response => ",a,r),r?(f.push("/todos"),localStorage.setItem("token",r)):alert("Username or Password is wrong"),e.next=16;break;case 15:alert("Wrong credentials");case 16:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(I.jsx)("div",{className:"login",children:Object(I.jsxs)("div",{className:"login_container",children:[Object(I.jsx)("h1",{children:"Please Sign In"}),Object(I.jsxs)("form",{onSubmit:h,children:[Object(I.jsx)("input",{name:"username",type:"text",onChange:b,value:n}),Object(I.jsx)("br",{}),Object(I.jsx)("input",{name:"password",type:"password",onChange:b,value:i}),Object(I.jsx)("br",{}),Object(I.jsx)("button",{onClick:h,children:"Sign In"})]})]})})};var A=function(){return Object(I.jsx)("div",{className:"App",children:Object(I.jsx)(c.a,{children:Object(I.jsxs)(s.c,{children:[Object(I.jsx)(s.a,{exact:!0,path:"/",children:Object(I.jsx)(D,{})}),Object(I.jsx)(s.a,{exact:!0,path:"/todos",children:Object(I.jsx)(U,{})})]})})})};r.a.render(Object(I.jsx)(A,{}),document.getElementById("root"))}},[[82,1,2]]]);
//# sourceMappingURL=main.2f9a6826.chunk.js.map